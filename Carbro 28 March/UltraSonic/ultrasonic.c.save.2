#include <stdio.h>
#include <wiringPi.h>
#include <time.h>

//#set GPIO Pins
#define GPIO_TRIGGER 18
#define GPIO_ECHO 24

//wiringPiSetup(); // Initializes wiringPi using wiringPi's simlified number system.
//wiringPiSetupGpio(); // Initializes wiringPi using the Broadcom GPIO pin numbers

//int GPIO_TRIGGER=18;
//int GPIO_ECHO=24;

int StartTime=0;
int StopTime=0;
int TimeElapsed=0;
int distU()
{
	
	int dist=0;
	digitalWrite(GPIO_TRIGGER, HIGH);

	delay(50);

	digitalWrite(GPIO_TRIGGER, LOW);

	StartTime=time(NULL);
	StopTime=time(NULL);

	// save StartTime
    while(digitalRead(GPIO_ECHO) == 0)
        {StartTime = time(NULL);}

    // save time of arrival
    while (digitalRead(GPIO_ECHO) == 1)
        {StopTime = time(NULL);}

	TimeElapsed=StopTime - StartTime;

	dist = (TimeElapsed * 34300) / 2;

    return dist;

}

int main(void)
{
    wiringPiSetupGpio();


pinMode(GPIO_TRIGGER, OUTPUT);
pinMode(GPIO_ECHO, INPUT);


    int dist=0;
    while(1)
    {
	dist=distU();
	printf("Measured Distance =%.1d",dist);
	delay(50);
    }
    return 0;
}
